generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String @id @default(cuid())
  username     String @unique
  passwordHash String @map("password_hash")
  name         String

  watched      Media[]       @relation("watched")
  watchList    Media[]       @relation("watchList")
  sponsorships Sponsorship[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Media {
  id     String    @id @default(cuid())
  imdbId String    @map("imdb_id")
  type   MediaType

  interestedUser   User?   @relation("watchList", fields: [interestedUserId], references: [id])
  interestedUserId String? @map("interested_user_id")

  watchedUser   User?         @relation("watched", fields: [watchedUserId], references: [id])
  watchedUserId String?       @map("watched_user_id")
  // @@unique([imdbId, interestedUserId, watchedUserId])

  @@map("medias")
}

model Sponsorship {
  id    String   @id @default(cuid())
  date  DateTime
  price Float
  mediaId Int
  imdbId String

  user    User   @relation(fields: [userId], references: [id])
  userId  String

  @@map("sponsorships")
}

enum MediaType {
  SERIES
  MOVIE
}
